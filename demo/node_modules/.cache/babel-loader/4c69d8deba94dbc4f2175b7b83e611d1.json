{"ast":null,"code":"import*as d3 from'd3';export function drawMap(height,width){var margin={top:50,right:50,bottom:50,left:50};var width=1300-margin.left-margin.right;var height=800-margin.top-margin.bottom;var svg=d3.select(\"#map1\").append(\"svg\").attr(\"width\",width+margin.left+margin.right).attr(\"height\",height+margin.top+margin.bottom).append(\"g\").attr(\"transform\",\"translate(\"+margin.left+\",\"+margin.top+\")\");/////////////////////////////////////////////////////////////\nvar promises=[];promises.push(d3.json(\"https://raw.githubusercontent.com/Heun-Johnson/dsci554projectdata/main/coh_area_simplified_rw.json\"));promises.push(d3.json(\"https://raw.githubusercontent.com/Heun-Johnson/dsci554projectdata/main/data.json\"));Promise.all(promises).then(function(values){//////////////////////////////////////////\n/// all for legend ///\nfunction legend(){let{color,title,tickSize=6,width=800,height=50+tickSize,marginTop=18,marginRight=0,marginBottom=16+tickSize,marginLeft=0,ticks=width/64,tickFormat,tickValues}=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return function(tickFormat,tickValues){var svg=d3.create(\"svg\").attr(\"width\",width).attr(\"height\",height).attr(\"viewBox\",[0,0,width,height]).style(\"overflow\",\"visible\").style(\"display\",\"block\");//discrete\nif(color.invertExtent){const thresholds=color.thresholds?color.thresholds()// scaleQuantize\n:color.quantiles?color.quantiles()// scaleQuantile\n:color.domain();// scaleThreshold\nconst thresholdFormat=tickFormat===undefined?d=>d:typeof tickFormat===\"string\"?d3.format(tickFormat):tickFormat;var x=d3.scaleLinear().domain([-1,color.range().length-1]).rangeRound([marginLeft,width-marginRight]);svg.append(\"g\").selectAll(\"rect\").data(color.range()).join(\"rect\").attr(\"x\",(d,i)=>x(i-1)).attr(\"y\",marginTop).attr(\"width\",(d,i)=>x(i)-x(i-1)).attr(\"height\",height-marginTop-marginBottom).attr(\"fill\",d=>d);var tickValues=d3.range(thresholds.length);var tickFormat=i=>thresholdFormat(thresholds[i],i);}svg.append(\"g\").attr(\"transform\",\"translate(0, \".concat(height-marginBottom,\")\")).call(d3.axisBottom(x).ticks(ticks,typeof tickFormat===\"string\"?tickFormat:undefined).tickFormat(typeof tickFormat===\"function\"?tickFormat:undefined).tickSize(tickSize).tickValues(tickValues)).call(g=>g.selectAll(\".tick line\").attr(\"y1\",marginTop+marginBottom-height)).call(g=>g.select(\".domain\").remove()).call(g=>g.append(\"text\").attr(\"y\",marginTop+marginBottom-height-6).attr(\"fill\",\"currentColor\").attr(\"text-anchor\",\"start\").attr(\"font-weight\",\"bold\").text(title));return svg.node();}(tickFormat,tickValues);}//////////////////////////////////////////////////\n/// data and map ///\nvar la_map=values[0];var canc_data=values[1];var color=d3.scaleQuantize([0,36],d3.schemeGreys[9]);var canc_data=Object.assign(new Map(canc_data.slice(1).map(_ref=>{let[zip_code,zip_canc_deaths_10k]=_ref;return[zip_code,+zip_canc_deaths_10k];})));canc_data.title=\"2019 cancer deaths per 10k\";var projection=d3.geoMercator().fitSize([width,height],la_map);var path=d3.geoPath().projection(projection);svg.append(\"g\").attr(\"transform\",\"translate(1000,80)\").append(()=>legend({color,title:canc_data.title,width:200}));svg.append('g').attr('class','zipcodes').selectAll(\"path\").data(la_map.features).enter().append('path').attr('d',path).attr(\"fill\",d=>color(canc_data.get(d.properties.zcta))).on('mouseover',function(){d3.select('#chor_info1').text('Zip code: '+this.__data__.properties.zcta+' - Total population: '+this.__data__.properties.tot_pop+' - Median age: '+this.__data__.properties.age_median+' years');d3.select(this).style(\"stroke\",'blue').style(\"stroke-width\",3);}).on(\"mouseout\",function(){d3.select(this).style(\"stroke\",'black').style(\"stroke-width\",0.2);});var coh_hosp=[-117.97265500193778,34.131232240226815];var marker=projection(coh_hosp);svg.append('circle').attr('cx',marker[0]).attr('cy',marker[1]).attr('fill','blue').attr('r',10);});}","map":{"version":3,"sources":["/Users/carlin/Desktop/USC_classes/DSCI_554/project-datadocs-real/demo/src/views/charts/MapChart.js"],"names":["d3","drawMap","height","width","margin","top","right","bottom","left","svg","select","append","attr","promises","push","json","Promise","all","then","values","legend","color","title","tickSize","marginTop","marginRight","marginBottom","marginLeft","ticks","tickFormat","tickValues","create","style","invertExtent","thresholds","quantiles","domain","thresholdFormat","undefined","d","format","x","scaleLinear","range","length","rangeRound","selectAll","data","join","i","call","axisBottom","g","remove","text","node","la_map","canc_data","scaleQuantize","schemeGreys","Object","assign","Map","slice","map","zip_code","zip_canc_deaths_10k","projection","geoMercator","fitSize","path","geoPath","features","enter","get","properties","zcta","on","__data__","tot_pop","age_median","coh_hosp","marker"],"mappings":"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","sourcesContent":["import * as d3 from 'd3';\n\nexport function drawMap(height, width){\n    var margin = { top: 50, right: 50, bottom: 50, left: 50 };\n    var width = 1300 - margin.left - margin.right;\n    var height = 800 - margin.top - margin.bottom;\n    \n    var svg = d3.select(\"#map1\")\n      .append(\"svg\")\n      .attr(\"width\", width + margin.left + margin.right)\n      .attr(\"height\", height + margin.top + margin.bottom)\n      .append(\"g\")\n      .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n    \n    \n    /////////////////////////////////////////////////////////////\n    \n    \n    var promises = [];\n    \n    promises.push(d3.json(\"https://raw.githubusercontent.com/Heun-Johnson/dsci554projectdata/main/coh_area_simplified_rw.json\"));\n    promises.push(d3.json(\"https://raw.githubusercontent.com/Heun-Johnson/dsci554projectdata/main/data.json\"));\n    \n    Promise.all(promises).then(function (values) {  \n    \n        //////////////////////////////////////////\n        /// all for legend ///\n        function legend({\n            color,\n            title,\n            tickSize = 6,\n            width = 800,\n            height = 50 + tickSize,\n            marginTop = 18,\n            marginRight = 0,\n            marginBottom = 16 + tickSize,\n            marginLeft = 0,\n            ticks = width / 64,\n            tickFormat,\n            tickValues\n        } = {}) {  \n        \n            var svg = d3.create(\"svg\")\n                .attr(\"width\", width)\n                .attr(\"height\", height)\n                .attr(\"viewBox\", [0, 0, width, height])\n                .style(\"overflow\", \"visible\")\n                .style(\"display\", \"block\");    \n        \n            //discrete\n            if (color.invertExtent) {\n                const thresholds\n                    = color.thresholds ? color.thresholds() // scaleQuantize\n                        : color.quantiles ? color.quantiles() // scaleQuantile\n                            : color.domain(); // scaleThreshold\n        \n                const thresholdFormat\n                    = tickFormat === undefined ? d => d\n                        : typeof tickFormat === \"string\" ? d3.format(tickFormat)\n                            : tickFormat;\n        \n                var x = d3.scaleLinear()\n                    .domain([-1, color.range().length - 1])\n                    .rangeRound([marginLeft, width - marginRight]);\n        \n                svg.append(\"g\")\n                    .selectAll(\"rect\")\n                    .data(color.range())\n                    .join(\"rect\")\n                    .attr(\"x\", (d, i) => x(i - 1))\n                    .attr(\"y\", marginTop)\n                    .attr(\"width\", (d, i) => x(i) - x(i - 1))\n                    .attr(\"height\", height - marginTop - marginBottom)\n                    .attr(\"fill\", d => d);\n        \n                var tickValues = d3.range(thresholds.length);\n                var tickFormat = i => thresholdFormat(thresholds[i], i);\n            }\n        \n            svg.append(\"g\")\n                .attr(\"transform\", `translate(0, ${height - marginBottom})`)\n                .call(d3.axisBottom(x)\n                    .ticks(ticks, typeof tickFormat === \"string\" ? tickFormat : undefined)\n                    .tickFormat(typeof tickFormat === \"function\" ? tickFormat : undefined)\n                    .tickSize(tickSize)\n                    .tickValues(tickValues))\n                .call(g => g.selectAll(\".tick line\").attr(\"y1\", marginTop + marginBottom - height))\n                .call(g => g.select(\".domain\").remove())\n                .call(g => g.append(\"text\")\n                    .attr(\"y\", marginTop + marginBottom - height - 6)\n                    .attr(\"fill\", \"currentColor\")\n                    .attr(\"text-anchor\", \"start\")\n                    .attr(\"font-weight\", \"bold\")\n                    .text(title));\n        \n            return svg.node();\n        }\n    \n        //////////////////////////////////////////////////\n        /// data and map ///\n    \n        var la_map = values[0];\n        var canc_data = values[1];\n    \n        var color = d3.scaleQuantize([0, 36], d3.schemeGreys[9])  \n    \n        var canc_data = Object.assign(new Map(canc_data.slice(1).map(([zip_code,zip_canc_deaths_10k]) => [zip_code, +zip_canc_deaths_10k])));  \n    \n        canc_data.title = \"2019 cancer deaths per 10k\";\n    \n        var projection = d3.geoMercator()\n            .fitSize([width, height], la_map);\n            \n        var path = d3.geoPath()\n            .projection(projection);\n    \n        svg.append(\"g\")\n            .attr(\"transform\", \"translate(1000,80)\")\n            .append(() => legend({ color, title: canc_data.title, width: 200 }));\n    \n        svg.append('g')\n            .attr('class', 'zipcodes')\n            .selectAll(\"path\")\n            .data(la_map.features)\n            .enter()\n            .append('path')\n            .attr('d', path)\n            .attr(\"fill\", d => color(canc_data.get(d.properties.zcta))) \n            .on('mouseover', function () {            \n                d3.select('#chor_info1')\n                    .text('Zip code: ' +  this.__data__.properties.zcta +  ' - Total population: ' +  this.__data__.properties.tot_pop + ' - Median age: ' +  this.__data__.properties.age_median + ' years');               \n                d3.select(this).style(\"stroke\", 'blue').style(\"stroke-width\",3);\n                })\n            .on(\"mouseout\", function () {\n              d3.select(this).style(\"stroke\", 'black').style(\"stroke-width\",0.2);\n            });    \n    \n    \n        var coh_hosp = [-117.97265500193778, 34.131232240226815];\n    \n        var marker = projection(coh_hosp);\n    \n        svg.append('circle')\n            .attr('cx', marker[0])\n            .attr('cy', marker[1])\n            .attr('fill', 'blue')\n            .attr('r', 10);\n    });    \n    \n}\n"]},"metadata":{},"sourceType":"module"}