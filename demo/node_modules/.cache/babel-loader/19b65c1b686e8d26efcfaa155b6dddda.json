{"ast":null,"code":"import * as d3 from 'd3';\nexport function drawChart() {\n  var margin = {\n    top: 20,\n    left: 75,\n    bottom: 50,\n    right: 50\n  },\n      width = 850 - margin.left - margin.right,\n      height = 500 - margin.top - margin.bottom;\n  var svg = d3.select('#chart').append('svg').attr('width', width + margin.left + margin.right).attr('height', height + margin.top + margin.bottom).append('g').attr('transform', 'translate(' + margin.left + ', ' + margin.top + ')');\n  var x = d3.scaleBand();\n  var y = d3.scaleLinear();\n\n  var delay = function (d, i) {\n    return i * 50;\n  };\n\n  var all, top5, bot5, orderName;\n  var current, sortMode, filterMode;\n  d3.csv('dx_race.csv', d => {\n    return {\n      race: d.race,\n      dx: +d.dx\n    };\n  }).then(data => {\n    all = data;\n    console.log(JSON.stringify(all)); //ðŸŽ’ set top5 to top 5 gdps in the group of countries using array.slice here\n\n    var top3 = data.sort((a, b) => d3.descending(a.dx, b.dx)).slice(0, 3); //ðŸŽ’ set bot5 to bottom 5 gdps in the group of countries using array.slice here\n\n    var bot3 = data.sort((a, b) => d3.ascending(a.dx, b.dx)).slice(0, 3);\n    filter('#all');\n    sort('#gdp_a');\n    toggleFilter('#all');\n    toggleSort('#gdp_a');\n    draw();\n  }); //sort event handlers\n\n  d3.select('#gdp_a').on('click', () => {\n    sort('#gdp_a');\n    transition();\n    toggleSort('#gdp_a');\n  });\n  d3.select('#gdp_b').on('click', () => {\n    sort('#gdp_b');\n    transition();\n    toggleSort('#gdp_b');\n  });\n  d3.select('#orderName').on('click', () => {\n    sort('#orderName');\n    transition();\n    toggleSort('#orderName');\n  });\n  d3.select('#reset').on('click', () => {\n    filter('#all');\n    sort('#orderName');\n    toggleSort(sortMode);\n    toggleFilter('#all');\n    transition();\n    toggleSort('#reset');\n    redraw();\n  }); ////\n  //filter event handlers\n\n  d3.select('#all').on('click', () => {\n    filter('#all');\n    sort(sortMode);\n    toggleSort(sortMode);\n    toggleFilter('#all');\n    redraw();\n  });\n  d3.select('#top5').on('click', () => {\n    filter('#top5');\n    sort(sortMode);\n    toggleSort(sortMode);\n    toggleFilter('#top5');\n    redraw();\n  });\n  d3.select('#bot5').on('click', () => {\n    filter('#bot5');\n    sort(sortMode);\n    toggleSort(sortMode);\n    toggleFilter('#bot5');\n    redraw();\n  });\n  d3.select('input').on('change', () => {\n    sort(sortMode);\n    toggleSort(sortMode);\n    redraw();\n  });\n\n  function filter(mode) {\n    if (mode === '#all') {\n      current = JSON.parse(JSON.stringify(all));\n    } else if (mode === '#top5') {\n      current = JSON.parse(JSON.stringify(top3));\n    } else if (mode === '#bot5') {\n      current = JSON.parse(JSON.stringify(bot3));\n    }\n\n    filterMode = mode;\n  }\n\n  function sort(mode) {\n    if (mode === '#gdp_a') {\n      current.sort((a, b) => d3.ascending(a.dx, b.dx));\n    } else if (mode === '#gdp_b') {\n      current.sort((a, b) => d3.descending(a.dx, b.dx));\n    } else if (mode === '#orderName') {\n      current.sort((a, b) => d3.ascending(a.race, b.race));\n    }\n\n    x.domain(current.map(d => d.race));\n    sortMode = mode;\n  }\n\n  function toggleSort(id) {\n    d3.selectAll('.sort').style('background-color', '#eee');\n    d3.select(id).style('background-color', 'lightblue');\n  } //ðŸŽ’ implement toggleFilter to highlight buttons with class .filter here (same as toggleSort with class .sort)\n\n\n  function toggleFilter(id) {\n    d3.selectAll('.filter').style('background-color', '#eee');\n    d3.select(id).style('background-color', 'lightblue');\n  } ///\n\n\n  function redraw() {\n    //update scale\n    x.domain(current.map(d => d.race)); ////////////////////////////////\n    // DATA JOIN FOR BARS.\n\n    var bars = svg.selectAll('.bar').data(current, d => d.race); // UPDATE.\n\n    bars.transition().duration(750).delay(delay).attr('x', d => x(d.race)).attr('width', x.bandwidth()); // ENTER.\n\n    bars.enter().append('rect').attr('x', d => x(d.race)).attr('y', d => y(0)).attr('width', x.bandwidth()).transition().duration(750).attr('class', 'bar').attr('x', d => x(d.race)).attr('y', d => y(d.dx)).attr('width', x.bandwidth()).attr('height', d => height - y(d.dx)); // EXIT.\n\n    bars.exit().transition().duration(750).style('opacity', 0).remove(); ////////////////////////////////\n    // DATA JOIN FOR NAMES.\n\n    var name = svg.selectAll('.name').data(current, d => d.race); // UPDATE.\n\n    name.transition().duration(750).delay(delay).attr('x', (d, i) => x(d.race) + x.bandwidth() / 2); // ENTER.\n\n    name.enter().append('text').attr('x', d => x(d.race) + x.bandwidth() / 2).attr('y', d => y(d.dx) + (height - y(d.dx)) / 2).style('opacity', 0).transition().duration(1000).text(d => d.race).attr('class', 'name').attr('x', d => x(d.race) + x.bandwidth() / 2).attr('y', d => y(d.dx) + (height - y(d.dx)) / 2).style('opacity', 1); // EXIT.\n\n    name.exit().transition().duration(750).style('opacity', 0).remove();\n  }\n\n  function transition() {\n    var transition = svg.transition().duration(750);\n    transition.selectAll('.bar').delay(delay).attr('x', d => x(d.race));\n    transition.selectAll('.name').delay(delay).attr('x', d => x(d.race) + x.bandwidth() / 2);\n  }\n\n  function draw() {\n    x.domain(current.map(d => d.race)).range([0, width]).paddingInner(0.2);\n    y.domain([0, d3.max(current, d => d.dx)]).range([height, 0]);\n    svg.selectAll('.bar').data(current, d => d.race).enter().append('rect').attr('class', 'bar').attr('x', d => x(d.race)).attr('y', d => y(d.dx)).attr('width', x.bandwidth()).attr('height', d => height - y(d.dx));\n    svg.selectAll('.name').data(current, d => d.race).enter().append('text').text(d => d.race).attr('class', 'name').attr('x', d => x(d.race) + x.bandwidth() / 2).attr('y', d => y(d.dx) + (height - y(d.dx)) / 2);\n    var xAxis;\n    xAxis = d3.axisBottom().scale(x).ticks(0).tickSize(0).tickFormat('');\n    svg.append('g').attr('class', 'axis').attr('transform', 'translate(0,' + height + ')').call(xAxis);\n    svg.append('text').attr('class', 'xlabel').text('smaller').attr('x', 30).attr('y', height + 20);\n    svg.append('text').attr('class', 'xlabel').text('larger').attr('x', width - 30).attr('y', height + 20);\n    var yAxis = d3.axisLeft().scale(y).ticks(5, 'd');\n    svg.append('g').attr('class', 'axis').call(yAxis);\n    svg.append('text').attr('x', -height / 2).attr('y', -margin.left * 0.7).attr('transform', 'rotate(-90)').attr('class', 'ylabel').append('tspan').text('Total diagonsed cases by race').append('tspan').text('-2').style('baseline-shift', 'super').style('font-size', '0.7em');\n  }\n}","map":{"version":3,"sources":["/Users/kevinrayjon/Documents/USC_MS_ADS/Fall_2021/DSCI_554/Project/project-datadocs/demo/src/views/charts/BarChartDemographics.js"],"names":["d3","drawChart","margin","top","left","bottom","right","width","height","svg","select","append","attr","x","scaleBand","y","scaleLinear","delay","d","i","all","top5","bot5","orderName","current","sortMode","filterMode","csv","race","dx","then","data","console","log","JSON","stringify","top3","sort","a","b","descending","slice","bot3","ascending","filter","toggleFilter","toggleSort","draw","on","transition","redraw","mode","parse","domain","map","id","selectAll","style","bars","duration","bandwidth","enter","exit","remove","name","text","range","paddingInner","max","xAxis","axisBottom","scale","ticks","tickSize","tickFormat","call","yAxis","axisLeft"],"mappings":"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","sourcesContent":["\nimport * as d3 from 'd3';\n\nexport function drawChart(){\n\nvar margin = { top: 20, left: 75, bottom: 50, right: 50 },\n    width = 850 - margin.left - margin.right,\n    height = 500 - margin.top - margin.bottom;\n\nvar svg = d3.select('#chart').append('svg')\n    .attr('width', width + margin.left + margin.right)\n    .attr('height', height + margin.top + margin.bottom)\n    .append('g')\n    .attr('transform', 'translate(' + margin.left + ', ' + margin.top + ')');\n\nvar x = d3.scaleBand();\nvar y = d3.scaleLinear();\n\nvar delay = function (d, i) {\n    return i * 50;\n};\n\nvar all, top5, bot5, orderName;\nvar current, sortMode, filterMode;\n\nd3.csv('dx_race.csv', d => {\n    return {\n        race: d.race,\n        dx: +d.dx\n    };\n}).then(data => {\n    all = data;\n    console.log(JSON.stringify(all));\n\n    //ðŸŽ’ set top5 to top 5 gdps in the group of countries using array.slice here\n    var top3 = data.sort((a, b) => d3.descending(a.dx, b.dx)).slice(0, 3);\n\n    //ðŸŽ’ set bot5 to bottom 5 gdps in the group of countries using array.slice here\n    var bot3 = data.sort((a, b) => d3.ascending(a.dx, b.dx)).slice(0, 3);\n\n\n    filter('#all');\n    sort('#gdp_a');\n\n    toggleFilter('#all');\n    toggleSort('#gdp_a');\n\n    draw();\n});\n\n//sort event handlers\nd3.select('#gdp_a')\n    .on('click', () => {\n        sort('#gdp_a');\n        transition();\n        toggleSort('#gdp_a');\n    });\n\nd3.select('#gdp_b')\n    .on('click', () => {\n        sort('#gdp_b');\n        transition();\n        toggleSort('#gdp_b');\n    });\n\n\nd3.select('#orderName')\n    .on('click', () => {\n        sort('#orderName');\n        transition();\n        toggleSort('#orderName');\n    });\n\nd3.select('#reset')\n    .on('click', () => {\n        filter('#all');\n        sort('#orderName');\n\n        toggleSort(sortMode);\n        toggleFilter('#all');\n\n        transition();\n        toggleSort('#reset');\n\n        redraw();\n    });\n\n////\n\n//filter event handlers\nd3.select('#all')\n    .on('click', () => {\n        filter('#all');\n        sort(sortMode);\n\n        toggleSort(sortMode);\n        toggleFilter('#all');\n\n        redraw();\n    });\n\nd3.select('#top5')\n    .on('click', () => {\n        filter('#top5');\n        sort(sortMode);\n\n        toggleSort(sortMode);\n        toggleFilter('#top5');\n\n        redraw();\n    });\n\nd3.select('#bot5')\n    .on('click', () => {\n        filter('#bot5');\n        sort(sortMode);\n\n        toggleSort(sortMode);\n        toggleFilter('#bot5');\n\n        redraw();\n    });\n\nd3.select('input')\n    .on('change', () => {\n\n        sort(sortMode);\n        toggleSort(sortMode);\n\n        redraw();\n    });\n\nfunction filter(mode) {\n    if (mode === '#all') {\n        current = JSON.parse(JSON.stringify(all));\n    } else if (mode === '#top5') {\n        current = JSON.parse(JSON.stringify(top3));\n    } else if (mode === '#bot5') {\n        current = JSON.parse(JSON.stringify(bot3));\n    }\n    filterMode = mode;\n}\n\nfunction sort(mode) {\n    if (mode === '#gdp_a') {\n        current.sort((a, b) => d3.ascending(a.dx, b.dx));\n    } else if (mode === '#gdp_b') {\n        current.sort((a, b) => d3.descending(a.dx, b.dx));\n    } else if (mode === '#orderName') {\n        current.sort((a, b) => d3.ascending(a.race, b.race));\n    }\n    x.domain(current.map(d => d.race));\n    sortMode = mode;\n}\n\nfunction toggleSort(id) {\n    d3.selectAll('.sort')\n        .style('background-color', '#eee');\n    d3.select(id)\n        .style('background-color', 'lightblue');\n}\n\n//ðŸŽ’ implement toggleFilter to highlight buttons with class .filter here (same as toggleSort with class .sort)\nfunction toggleFilter(id) {\n    d3.selectAll('.filter')\n        .style('background-color', '#eee');\n    d3.select(id)\n        .style('background-color', 'lightblue');\n}\n///\n\nfunction redraw() {\n    //update scale\n    x.domain(current.map(d => d.race));\n\n    ////////////////////////////////\n    // DATA JOIN FOR BARS.\n    var bars = svg.selectAll('.bar')\n        .data(current, d => d.race);\n\n    // UPDATE.\n    bars.transition()\n        .duration(750)\n        .delay(delay)\n        .attr('x', d => x(d.race))\n        .attr('width', x.bandwidth());\n\n    // ENTER.\n    bars.enter()\n        .append('rect')\n        .attr('x', d => x(d.race))\n        .attr('y', d => y(0))\n        .attr('width', x.bandwidth())\n        .transition()\n        .duration(750)\n        .attr('class', 'bar')\n        .attr('x', d => x(d.race))\n        .attr('y', d => y(d.dx))\n        .attr('width', x.bandwidth())\n        .attr('height', d => height - y(d.dx));\n\n    // EXIT.\n    bars.exit()\n        .transition()\n        .duration(750)\n        .style('opacity', 0)\n        .remove();\n\n    ////////////////////////////////\n    // DATA JOIN FOR NAMES.\n    var name = svg.selectAll('.name')\n        .data(current, d => d.race);\n\n    // UPDATE.\n    name.transition()\n        .duration(750)\n        .delay(delay)\n        .attr('x', (d, i) => x(d.race) + x.bandwidth() / 2);\n\n    // ENTER.\n    name.enter()\n        .append('text')\n        .attr('x', d => x(d.race) + x.bandwidth() / 2)\n        .attr('y', d => y(d.dx) + (height - y(d.dx)) / 2)\n        .style('opacity', 0)\n        .transition()\n        .duration(1000)\n        .text(d => d.race)\n        .attr('class', 'name')\n        .attr('x', d => x(d.race) + x.bandwidth() / 2)\n        .attr('y', d => y(d.dx) + (height - y(d.dx)) / 2)\n        .style('opacity', 1);\n\n    // EXIT.\n    name.exit()\n        .transition()\n        .duration(750)\n        .style('opacity', 0)\n        .remove();\n}\n\nfunction transition() {\n    var transition = svg.transition()\n        .duration(750);\n\n    transition.selectAll('.bar')\n        .delay(delay)\n        .attr('x', d => x(d.race));\n\n    transition.selectAll('.name')\n        .delay(delay)\n        .attr('x', d => x(d.race) + x.bandwidth() / 2);\n}\n\nfunction draw() {\n    x.domain(current.map(d => d.race))\n        .range([0, width])\n        .paddingInner(0.2);\n\n    y.domain([0, d3.max(current, d => d.dx)])\n        .range([height, 0]);\n\n    svg.selectAll('.bar')\n        .data(current, d => d.race)\n        .enter()\n        .append('rect')\n        .attr('class', 'bar')\n        .attr('x', d => x(d.race))\n        .attr('y', d => y(d.dx))\n        .attr('width', x.bandwidth())\n        .attr('height', d => height - y(d.dx));\n\n    svg.selectAll('.name')\n        .data(current, d => d.race)\n        .enter()\n        .append('text')\n        .text(d => d.race)\n        .attr('class', 'name')\n        .attr('x', d => x(d.race) + x.bandwidth() / 2)\n        .attr('y', d => y(d.dx) + (height - y(d.dx)) / 2);\n\n    var xAxis;\n    xAxis = d3.axisBottom()\n        .scale(x)\n        .ticks(0)\n        .tickSize(0)\n        .tickFormat('');\n\n    svg.append('g')\n        .attr('class', 'axis')\n        .attr('transform', 'translate(0,' + height + ')')\n        .call(xAxis);\n\n    svg.append('text')\n        .attr('class', 'xlabel')\n        .text('smaller')\n        .attr('x', 30)\n        .attr('y', height + 20);\n\n    svg.append('text')\n        .attr('class', 'xlabel')\n        .text('larger')\n        .attr('x', width - 30)\n        .attr('y', height + 20);\n\n    var yAxis = d3.axisLeft()\n        .scale(y)\n        .ticks(5, 'd');\n\n    svg.append('g')\n        .attr('class', 'axis')\n        .call(yAxis);\n\n    svg.append('text')\n        .attr('x', - height / 2)\n        .attr('y', - margin.left * 0.7)\n        .attr('transform', 'rotate(-90)')\n        .attr('class', 'ylabel')\n        .append('tspan').text('Total diagonsed cases by race')\n        .append('tspan').text('-2')\n        .style('baseline-shift', 'super')\n        .style('font-size', '0.7em');\n}\n\n}"]},"metadata":{},"sourceType":"module"}