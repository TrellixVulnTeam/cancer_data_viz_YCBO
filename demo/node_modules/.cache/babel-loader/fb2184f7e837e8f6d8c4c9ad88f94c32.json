{"ast":null,"code":"import*as d3 from'd3';export function drawChart(){var margin={top:20,left:75,bottom:50,right:50},width=850-margin.left-margin.right,height=500-margin.top-margin.bottom;var svg=d3.select('#chart').append('svg').attr('width',width+margin.left+margin.right).attr('height',height+margin.top+margin.bottom).append('g').attr('transform','translate('+margin.left+', '+margin.top+')');var x=d3.scaleBand();var y=d3.scaleLinear();// var top3, bot3;\nvar delay=function(d,i){return i*50;};var all,orderName;var current,sortMode,filterMode;d3.csv(\"https://raw.githubusercontent.com/hkerkevin/dsci554/main/dx_race.csv\",d=>{return{race:d.race,dx:+d.dx};}).then(data=>{all=data;console.log(JSON.stringify(all));//ðŸŽ’ set top5 to top 5 gdps in the group of countries using array.slice here\n// top3 = data.sort((a, b) => d3.descending(a.dx, b.dx)).slice(0, 3);\n//ðŸŽ’ set bot5 to bottom 5 gdps in the group of countries using array.slice here\n// bot3 = data.sort((a, b) => d3.ascending(a.dx, b.dx)).slice(0, 3);\nfilter('#all');sort('#gdp_a');toggleFilter('#all');toggleSort('#gdp_a');draw();});//sort event handlers\nd3.select('#gdp_a').style(\"background-color\",\"white\").style(\"border\",\"solid\").style(\"border-width\",\"2px\").style(\"border-radius\",\"5px\").on('click',()=>{sort('#gdp_a');transition();toggleSort('#gdp_a');});d3.select('#gdp_b').style(\"background-color\",\"white\").style(\"border\",\"solid\").style(\"border-width\",\"2px\").style(\"border-radius\",\"5px\").on('click',()=>{sort('#gdp_b');transition();toggleSort('#gdp_b');});d3.select('#orderName').style(\"background-color\",\"white\").style(\"border\",\"solid\").style(\"border-width\",\"2px\").style(\"border-radius\",\"5px\").on('click',()=>{sort('#orderName');transition();toggleSort('#orderName');});d3.select('#reset').style(\"opacity\",0)//get rid of reset just to see what it looks like\n.style(\"background-color\",\"white\").style(\"border\",\"solid\").style(\"border-width\",\"2px\").style(\"border-radius\",\"5px\").on('click',()=>{filter('#all');sort('#orderName');toggleSort(sortMode);toggleFilter('#all');transition();toggleSort('#reset');redraw();});////\n//filter event handlers\nd3.select('#all').on('click',()=>{filter('#all');sort(sortMode);toggleSort(sortMode);toggleFilter('#all');redraw();});d3.select('input').on('change',()=>{sort(sortMode);toggleSort(sortMode);redraw();});function filter(mode){if(mode==='#all'){current=JSON.parse(JSON.stringify(all));}// } else if (mode === '#top5') {\n//     current = JSON.parse(JSON.stringify(top3));\n// } else if (mode === '#bot5') {\n//     current = JSON.parse(JSON.stringify(bot3));\n// }\nfilterMode=mode;}function sort(mode){if(mode==='#gdp_a'){current.sort((a,b)=>d3.ascending(a.dx,b.dx));}else if(mode==='#gdp_b'){current.sort((a,b)=>d3.descending(a.dx,b.dx));}else if(mode==='#orderName'){current.sort((a,b)=>d3.ascending(a.race,b.race));}x.domain(current.map(d=>d.race));sortMode=mode;}function toggleSort(id){d3.selectAll('.sort').style('background-color','#eee');d3.select(id).style('background-color','lightblue');}//ðŸŽ’ implement toggleFilter to highlight buttons with class .filter here (same as toggleSort with class .sort)\nfunction toggleFilter(id){d3.selectAll('.filter').style('background-color','#eee');d3.select(id).style('background-color','lightblue');}///\nfunction redraw(){//update scale\nx.domain(current.map(d=>d.race));////////////////////////////////\n// DATA JOIN FOR BARS.\nvar bars=svg.selectAll('.bar').data(current,d=>d.race);// UPDATE.\nbars.transition().duration(750).delay(delay).attr('x',d=>x(d.race)).attr('width',x.bandwidth());// ENTER.\nbars.enter().append('rect').attr('x',d=>x(d.race)).attr('y',d=>y(0)).attr('width',x.bandwidth()).transition().duration(750).attr('class','bar').attr('x',d=>x(d.race)).attr('y',d=>y(d.dx)).attr('width',x.bandwidth()).attr('height',d=>height-y(d.dx));// EXIT.\nbars.exit().transition().duration(750).style('opacity',0).remove();////////////////////////////////\n// DATA JOIN FOR NAMES.\nvar name=svg.selectAll('.name').data(current,d=>d.race);// UPDATE.\nname.transition().duration(750).delay(delay).attr('x',(d,i)=>x(d.race)+x.bandwidth()/2);// ENTER.\nname.enter().append('text').attr('x',d=>x(d.race)+x.bandwidth()/2).attr('y',d=>y(d.dx)+(height-y(d.dx))/2).style('opacity',0).transition().duration(1000).text(d=>d.race).attr('class','name').attr('x',d=>x(d.race)+x.bandwidth()/2).attr('y',d=>y(d.dx)+(height-y(d.dx))/2).style('opacity',1);// EXIT.\nname.exit().transition().duration(750).style('opacity',0).remove();}function transition(){var transition=svg.transition().duration(750);transition.selectAll('.bar').delay(delay).attr('x',d=>x(d.race));transition.selectAll('.name').delay(delay).attr('x',d=>x(d.race)+x.bandwidth()/2);}function draw(){x.domain(current.map(d=>d.race)).range([0,width]).paddingInner(0.2);y.domain([0,d3.max(current,d=>d.dx)]).range([height,0]);svg.selectAll('.bar').data(current,d=>d.race).enter().append('rect').attr('class','bar').attr('x',d=>x(d.race)).attr('y',d=>y(d.dx)).attr('width',x.bandwidth()).attr('height',d=>height-y(d.dx)).attr('fill','#add8e677');svg.selectAll('.name').data(current,d=>d.race).enter().append('text').text(d=>d.race).attr('class','name').attr('text-anchor','middle').attr('font-weight','bold').attr('alignment-baseline','central').attr('x',d=>x(d.race)+x.bandwidth()/2).attr('y',d=>y(d.dx)+(height-y(d.dx))/2);var xAxis;xAxis=d3.axisBottom().scale(x).ticks(0).tickSize(0).tickFormat('');svg.append('g').attr('class','axis').attr('transform','translate(0,'+height+')').call(xAxis);var yAxis=d3.axisLeft().scale(y).ticks(5,'d');svg.append('g').attr('class','axis').call(yAxis);svg.append('text').attr('x',-height/2).attr('y',-margin.left*0.7).attr('transform','rotate(-90)').attr('text-anchor','middle').attr('alignment-baseline','central').attr('class','ylabel').append('tspan').text('Total diagonsed cases by race').append('tspan').text('-2').style('baseline-shift','super').style('font-size','0.7em');}}","map":{"version":3,"sources":["/Users/carlin/Desktop/USC_classes/DSCI_554/project-datadocs-real/demo/src/views/charts/BarChartDemographics.js"],"names":["d3","drawChart","margin","top","left","bottom","right","width","height","svg","select","append","attr","x","scaleBand","y","scaleLinear","delay","d","i","all","orderName","current","sortMode","filterMode","csv","race","dx","then","data","console","log","JSON","stringify","filter","sort","toggleFilter","toggleSort","draw","style","on","transition","redraw","mode","parse","a","b","ascending","descending","domain","map","id","selectAll","bars","duration","bandwidth","enter","exit","remove","name","text","range","paddingInner","max","xAxis","axisBottom","scale","ticks","tickSize","tickFormat","call","yAxis","axisLeft"],"mappings":"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","sourcesContent":["\nimport * as d3 from 'd3';\n\nexport function drawChart(){\n\nvar margin = { top: 20, left: 75, bottom: 50, right: 50 },\n    width = 850 - margin.left - margin.right,\n    height = 500 - margin.top - margin.bottom;\n\nvar svg = d3.select('#chart').append('svg')\n    .attr('width', width + margin.left + margin.right)\n    .attr('height', height + margin.top + margin.bottom)\n    .append('g')\n    .attr('transform', 'translate(' + margin.left + ', ' + margin.top + ')');\n\nvar x = d3.scaleBand();\nvar y = d3.scaleLinear();\n\n// var top3, bot3;\n\nvar delay = function (d, i) {\n    return i * 50;\n};\n\nvar all, orderName;\nvar current, sortMode, filterMode;\n\nd3.csv(\"https://raw.githubusercontent.com/hkerkevin/dsci554/main/dx_race.csv\", d => {\n    return {\n        race: d.race,\n        dx: +d.dx\n    };\n}).then(data => {\n    all = data;\n    console.log(JSON.stringify(all));\n\n    //ðŸŽ’ set top5 to top 5 gdps in the group of countries using array.slice here\n    // top3 = data.sort((a, b) => d3.descending(a.dx, b.dx)).slice(0, 3);\n\n    //ðŸŽ’ set bot5 to bottom 5 gdps in the group of countries using array.slice here\n    // bot3 = data.sort((a, b) => d3.ascending(a.dx, b.dx)).slice(0, 3);\n\n\n    filter('#all');\n    sort('#gdp_a');\n\n    toggleFilter('#all');\n    toggleSort('#gdp_a');\n\n    draw();\n});\n\n//sort event handlers\nd3.select('#gdp_a')\n.style(\"background-color\", \"white\")\n.style(\"border\", \"solid\")\n.style(\"border-width\", \"2px\")\n.style(\"border-radius\", \"5px\")\n    .on('click', () => {\n        sort('#gdp_a');\n        transition();\n        toggleSort('#gdp_a');\n    });\n\nd3.select('#gdp_b')\n.style(\"background-color\", \"white\")\n.style(\"border\", \"solid\")\n.style(\"border-width\", \"2px\")\n.style(\"border-radius\", \"5px\")\n    .on('click', () => {\n        sort('#gdp_b');\n        transition();\n        toggleSort('#gdp_b');\n    });\n\n\nd3.select('#orderName')\n.style(\"background-color\", \"white\")\n.style(\"border\", \"solid\")\n.style(\"border-width\", \"2px\")\n.style(\"border-radius\", \"5px\")\n    .on('click', () => {\n        sort('#orderName');\n        transition();\n        toggleSort('#orderName');\n    });\n\nd3.select('#reset')\n.style(\"opacity\", 0) //get rid of reset just to see what it looks like\n.style(\"background-color\", \"white\")\n.style(\"border\", \"solid\")\n.style(\"border-width\", \"2px\")\n.style(\"border-radius\", \"5px\")\n    .on('click', () => {\n        filter('#all');\n        sort('#orderName');\n\n        toggleSort(sortMode);\n        toggleFilter('#all');\n\n        transition();\n        toggleSort('#reset');\n\n        redraw();\n    });\n\n////\n\n//filter event handlers\nd3.select('#all')\n    .on('click', () => {\n        filter('#all');\n        sort(sortMode);\n\n        toggleSort(sortMode);\n        toggleFilter('#all');\n\n        redraw();\n    });\n\nd3.select('input')\n    .on('change', () => {\n\n        sort(sortMode);\n        toggleSort(sortMode);\n\n        redraw();\n    });\n\nfunction filter(mode) {\n    if (mode === '#all') {\n        current = JSON.parse(JSON.stringify(all));\n    }\n    // } else if (mode === '#top5') {\n    //     current = JSON.parse(JSON.stringify(top3));\n    // } else if (mode === '#bot5') {\n    //     current = JSON.parse(JSON.stringify(bot3));\n    // }\n    filterMode = mode;\n}\n\nfunction sort(mode) {\n    if (mode === '#gdp_a') {\n        current.sort((a, b) => d3.ascending(a.dx, b.dx));\n    } else if (mode === '#gdp_b') {\n        current.sort((a, b) => d3.descending(a.dx, b.dx));\n    } else if (mode === '#orderName') {\n        current.sort((a, b) => d3.ascending(a.race, b.race));\n    }\n    x.domain(current.map(d => d.race));\n    sortMode = mode;\n}\n\nfunction toggleSort(id) {\n    d3.selectAll('.sort')\n        .style('background-color', '#eee');\n    d3.select(id)\n        .style('background-color', 'lightblue');\n}\n\n//ðŸŽ’ implement toggleFilter to highlight buttons with class .filter here (same as toggleSort with class .sort)\nfunction toggleFilter(id) {\n    d3.selectAll('.filter')\n        .style('background-color', '#eee');\n    d3.select(id)\n        .style('background-color', 'lightblue');\n}\n///\n\nfunction redraw() {\n    //update scale\n    x.domain(current.map(d => d.race));\n\n    ////////////////////////////////\n    // DATA JOIN FOR BARS.\n    var bars = svg.selectAll('.bar')\n        .data(current, d => d.race);\n\n    // UPDATE.\n    bars.transition()\n        .duration(750)\n        .delay(delay)\n        .attr('x', d => x(d.race))\n        .attr('width', x.bandwidth());\n\n    // ENTER.\n    bars.enter()\n        .append('rect')\n        .attr('x', d => x(d.race))\n        .attr('y', d => y(0))\n        .attr('width', x.bandwidth())\n        .transition()\n        .duration(750)\n        .attr('class', 'bar')\n        .attr('x', d => x(d.race))\n        .attr('y', d => y(d.dx))\n        .attr('width', x.bandwidth())\n        .attr('height', d => height - y(d.dx));\n\n    // EXIT.\n    bars.exit()\n        .transition()\n        .duration(750)\n        .style('opacity', 0)\n        .remove();\n\n    ////////////////////////////////\n    // DATA JOIN FOR NAMES.\n    var name = svg.selectAll('.name')\n        .data(current, d => d.race);\n\n    // UPDATE.\n    name.transition()\n        .duration(750)\n        .delay(delay)\n        .attr('x', (d, i) => x(d.race) + x.bandwidth() / 2);\n\n    // ENTER.\n    name.enter()\n        .append('text')\n        .attr('x', d => x(d.race) + x.bandwidth() / 2)\n        .attr('y', d => y(d.dx) + (height - y(d.dx)) / 2)\n        .style('opacity', 0)\n        .transition()\n        .duration(1000)\n        .text(d => d.race)\n        .attr('class', 'name')\n        .attr('x', d => x(d.race) + x.bandwidth() / 2)\n        .attr('y', d => y(d.dx) + (height - y(d.dx)) / 2)\n        .style('opacity', 1);\n\n    // EXIT.\n    name.exit()\n        .transition()\n        .duration(750)\n        .style('opacity', 0)\n        .remove();\n}\n\nfunction transition() {\n    var transition = svg.transition()\n        .duration(750);\n\n    transition.selectAll('.bar')\n        .delay(delay)\n        .attr('x', d => x(d.race));\n\n    transition.selectAll('.name')\n        .delay(delay)\n        .attr('x', d => x(d.race) + x.bandwidth() / 2);\n}\n\nfunction draw() {\n    x.domain(current.map(d => d.race))\n        .range([0, width])\n        .paddingInner(0.2);\n\n    y.domain([0, d3.max(current, d => d.dx)])\n        .range([height, 0]);\n\n    svg.selectAll('.bar')\n        .data(current, d => d.race)\n        .enter()\n        .append('rect')\n        .attr('class', 'bar')\n        .attr('x', d => x(d.race))\n        .attr('y', d => y(d.dx))\n        .attr('width', x.bandwidth())\n        .attr('height', d => height - y(d.dx))\n        .attr('fill', '#add8e677');\n\n    svg.selectAll('.name')\n        .data(current, d => d.race)\n        .enter()\n        .append('text')\n        .text(d => d.race)\n        .attr('class', 'name')\n        .attr('text-anchor', 'middle')\n        .attr('font-weight', 'bold')\n        .attr('alignment-baseline', 'central')\n        .attr('x', d => x(d.race) + x.bandwidth() / 2)\n        .attr('y', d => y(d.dx) + (height - y(d.dx)) / 2);\n\n    var xAxis;\n    xAxis = d3.axisBottom()\n        .scale(x)\n        .ticks(0)\n        .tickSize(0)\n        .tickFormat('');\n\n    svg.append('g')\n        .attr('class', 'axis')\n        .attr('transform', 'translate(0,' + height + ')')\n        .call(xAxis);\n\n\n    var yAxis = d3.axisLeft()\n        .scale(y)\n        .ticks(5, 'd');\n\n    svg.append('g')\n        .attr('class', 'axis')\n        .call(yAxis);\n\n    svg.append('text')\n        .attr('x', - height / 2)\n        .attr('y', - margin.left * 0.7)\n        .attr('transform', 'rotate(-90)')\n        .attr('text-anchor', 'middle')\n        .attr('alignment-baseline', 'central')\n        .attr('class', 'ylabel')\n        .append('tspan').text('Total diagonsed cases by race')\n        .append('tspan').text('-2')\n        .style('baseline-shift', 'super')\n        .style('font-size', '0.7em');\n}\n\n}"]},"metadata":{},"sourceType":"module"}