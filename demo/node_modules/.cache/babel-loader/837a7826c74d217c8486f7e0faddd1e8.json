{"ast":null,"code":"import * as d3 from 'd3';\nexport function drawChart() {\n  var margin = {\n    top: 20,\n    left: 75,\n    bottom: 50,\n    right: 50\n  },\n      width = 850 - margin.left - margin.right,\n      height = 500 - margin.top - margin.bottom;\n  var svg = d3.select('#chart').append('svg').attr('width', width + margin.left + margin.right).attr('height', height + margin.top + margin.bottom).append('g').attr('transform', 'translate(' + margin.left + ', ' + margin.top + ')');\n  var x = d3.scaleBand();\n  var y = d3.scaleLinear(); // var top3, bot3;\n\n  var delay = function (d, i) {\n    return i * 50;\n  };\n\n  var all, orderName;\n  var current, sortMode, filterMode;\n  d3.csv(\"https://raw.githubusercontent.com/hkerkevin/dsci554/main/dx_race.csv\", d => {\n    return {\n      race: d.race,\n      dx: +d.dx\n    };\n  }).then(data => {\n    all = data;\n    console.log(JSON.stringify(all)); //ðŸŽ’ set top5 to top 5 gdps in the group of countries using array.slice here\n    // top3 = data.sort((a, b) => d3.descending(a.dx, b.dx)).slice(0, 3);\n    //ðŸŽ’ set bot5 to bottom 5 gdps in the group of countries using array.slice here\n    // bot3 = data.sort((a, b) => d3.ascending(a.dx, b.dx)).slice(0, 3);\n\n    filter('#all');\n    sort('#gdp_a');\n    toggleFilter('#all');\n    toggleSort('#gdp_a');\n    draw();\n  }); //sort event handlers\n\n  d3.select('#gdp_a').on('click', () => {\n    sort('#gdp_a');\n    transition();\n    toggleSort('#gdp_a');\n  });\n  d3.select('#gdp_b').on('click', () => {\n    sort('#gdp_b');\n    transition();\n    toggleSort('#gdp_b');\n  });\n  d3.select('#orderName').on('click', () => {\n    sort('#orderName');\n    transition();\n    toggleSort('#orderName');\n  });\n  d3.select('#reset').on('click', () => {\n    filter('#all');\n    sort('#orderName');\n    toggleSort(sortMode);\n    toggleFilter('#all');\n    transition();\n    toggleSort('#reset');\n    redraw();\n  }); ////\n  //filter event handlers\n\n  d3.select('#all').on('click', () => {\n    filter('#all');\n    sort(sortMode);\n    toggleSort(sortMode);\n    toggleFilter('#all');\n    redraw();\n  });\n  d3.select('input').on('change', () => {\n    sort(sortMode);\n    toggleSort(sortMode);\n    redraw();\n  });\n\n  function filter(mode) {\n    if (mode === '#all') {\n      current = JSON.parse(JSON.stringify(all));\n    } // } else if (mode === '#top5') {\n    //     current = JSON.parse(JSON.stringify(top3));\n    // } else if (mode === '#bot5') {\n    //     current = JSON.parse(JSON.stringify(bot3));\n    // }\n\n\n    filterMode = mode;\n  }\n\n  function sort(mode) {\n    if (mode === '#gdp_a') {\n      current.sort((a, b) => d3.ascending(a.dx, b.dx));\n    } else if (mode === '#gdp_b') {\n      current.sort((a, b) => d3.descending(a.dx, b.dx));\n    } else if (mode === '#orderName') {\n      current.sort((a, b) => d3.ascending(a.race, b.race));\n    }\n\n    x.domain(current.map(d => d.race));\n    sortMode = mode;\n  }\n\n  function toggleSort(id) {\n    d3.selectAll('.sort').style('background-color', '#eee');\n    d3.select(id).style('background-color', 'lightblue');\n  } //ðŸŽ’ implement toggleFilter to highlight buttons with class .filter here (same as toggleSort with class .sort)\n\n\n  function toggleFilter(id) {\n    d3.selectAll('.filter').style('background-color', '#eee');\n    d3.select(id).style('background-color', 'lightblue');\n  } ///\n\n\n  function redraw() {\n    //update scale\n    x.domain(current.map(d => d.race)); ////////////////////////////////\n    // DATA JOIN FOR BARS.\n\n    var bars = svg.selectAll('.bar').data(current, d => d.race); // UPDATE.\n\n    bars.transition().duration(750).delay(delay).attr('x', d => x(d.race)).attr('width', x.bandwidth()); // ENTER.\n\n    bars.enter().append('rect').attr('x', d => x(d.race)).attr('y', d => y(0)).attr('width', x.bandwidth()).transition().duration(750).attr('class', 'bar').attr('x', d => x(d.race)).attr('y', d => y(d.dx)).attr('width', x.bandwidth()).attr('height', d => height - y(d.dx)); // EXIT.\n\n    bars.exit().transition().duration(750).style('opacity', 0).remove(); ////////////////////////////////\n    // DATA JOIN FOR NAMES.\n\n    var name = svg.selectAll('.name').data(current, d => d.race); // UPDATE.\n\n    name.transition().duration(750).delay(delay).attr('x', (d, i) => x(d.race) + x.bandwidth() / 2); // ENTER.\n\n    name.enter().append('text').attr('x', d => x(d.race) + x.bandwidth() / 2).attr('y', d => y(d.dx) + (height - y(d.dx)) / 2).style('opacity', 0).transition().duration(1000).text(d => d.race).attr('class', 'name').attr('x', d => x(d.race) + x.bandwidth() / 2).attr('y', d => y(d.dx) + (height - y(d.dx)) / 2).style('opacity', 1); // EXIT.\n\n    name.exit().transition().duration(750).style('opacity', 0).remove();\n  }\n\n  function transition() {\n    var transition = svg.transition().duration(750);\n    transition.selectAll('.bar').delay(delay).attr('x', d => x(d.race));\n    transition.selectAll('.name').delay(delay).attr('x', d => x(d.race) + x.bandwidth() / 2);\n  }\n\n  function draw() {\n    x.domain(current.map(d => d.race)).range([0, width]).paddingInner(0.2);\n    y.domain([0, d3.max(current, d => d.dx)]).range([height, 0]);\n    svg.selectAll('.bar').data(current, d => d.race).enter().append('rect').attr('class', 'bar').attr('x', d => x(d.race)).attr('y', d => y(d.dx)).attr('width', x.bandwidth()).attr('height', d => height - y(d.dx)).attr('fill', '#add8e677');\n    svg.selectAll('.name').data(current, d => d.race).enter().append('text').text(d => d.race).attr('class', 'name').attr('x', d => x(d.race) + x.bandwidth() / 2).attr('y', d => y(d.dx) + (height - y(d.dx)) / 2);\n    var xAxis;\n    xAxis = d3.axisBottom().scale(x).ticks(0).tickSize(0).tickFormat('');\n    svg.append('g').attr('class', 'axis').attr('transform', 'translate(0,' + height + ')').call(xAxis);\n    var yAxis = d3.axisLeft().scale(y).ticks(5, 'd');\n    svg.append('g').attr('class', 'axis').call(yAxis);\n    svg.append('text').attr('x', -height / 2).attr('y', -margin.left * 0.7).attr('transform', 'rotate(-90)').attr('text-anchor', 'middle').attr('alignment-baseline', 'central').attr('class', 'ylabel').append('tspan').text('Total diagonsed cases by race').append('tspan').text('-2').style('baseline-shift', 'super').style('font-size', '0.7em');\n  }\n}","map":{"version":3,"sources":["/Users/kevinrayjon/Documents/USC_MS_ADS/Fall_2021/DSCI_554/Project/project-datadocs/demo/src/views/charts/BarChartDemographics.js"],"names":["d3","drawChart","margin","top","left","bottom","right","width","height","svg","select","append","attr","x","scaleBand","y","scaleLinear","delay","d","i","all","orderName","current","sortMode","filterMode","csv","race","dx","then","data","console","log","JSON","stringify","filter","sort","toggleFilter","toggleSort","draw","on","transition","redraw","mode","parse","a","b","ascending","descending","domain","map","id","selectAll","style","bars","duration","bandwidth","enter","exit","remove","name","text","range","paddingInner","max","xAxis","axisBottom","scale","ticks","tickSize","tickFormat","call","yAxis","axisLeft"],"mappings":"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","sourcesContent":["\nimport * as d3 from 'd3';\n\nexport function drawChart(){\n\nvar margin = { top: 20, left: 75, bottom: 50, right: 50 },\n    width = 850 - margin.left - margin.right,\n    height = 500 - margin.top - margin.bottom;\n\nvar svg = d3.select('#chart').append('svg')\n    .attr('width', width + margin.left + margin.right)\n    .attr('height', height + margin.top + margin.bottom)\n    .append('g')\n    .attr('transform', 'translate(' + margin.left + ', ' + margin.top + ')');\n\nvar x = d3.scaleBand();\nvar y = d3.scaleLinear();\n\n// var top3, bot3;\n\nvar delay = function (d, i) {\n    return i * 50;\n};\n\nvar all, orderName;\nvar current, sortMode, filterMode;\n\nd3.csv(\"https://raw.githubusercontent.com/hkerkevin/dsci554/main/dx_race.csv\", d => {\n    return {\n        race: d.race,\n        dx: +d.dx\n    };\n}).then(data => {\n    all = data;\n    console.log(JSON.stringify(all));\n\n    //ðŸŽ’ set top5 to top 5 gdps in the group of countries using array.slice here\n    // top3 = data.sort((a, b) => d3.descending(a.dx, b.dx)).slice(0, 3);\n\n    //ðŸŽ’ set bot5 to bottom 5 gdps in the group of countries using array.slice here\n    // bot3 = data.sort((a, b) => d3.ascending(a.dx, b.dx)).slice(0, 3);\n\n\n    filter('#all');\n    sort('#gdp_a');\n\n    toggleFilter('#all');\n    toggleSort('#gdp_a');\n\n    draw();\n});\n\n//sort event handlers\nd3.select('#gdp_a')\n    .on('click', () => {\n        sort('#gdp_a');\n        transition();\n        toggleSort('#gdp_a');\n    });\n\nd3.select('#gdp_b')\n    .on('click', () => {\n        sort('#gdp_b');\n        transition();\n        toggleSort('#gdp_b');\n    });\n\n\nd3.select('#orderName')\n    .on('click', () => {\n        sort('#orderName');\n        transition();\n        toggleSort('#orderName');\n    });\n\nd3.select('#reset')\n    .on('click', () => {\n        filter('#all');\n        sort('#orderName');\n\n        toggleSort(sortMode);\n        toggleFilter('#all');\n\n        transition();\n        toggleSort('#reset');\n\n        redraw();\n    });\n\n////\n\n//filter event handlers\nd3.select('#all')\n    .on('click', () => {\n        filter('#all');\n        sort(sortMode);\n\n        toggleSort(sortMode);\n        toggleFilter('#all');\n\n        redraw();\n    });\n\nd3.select('input')\n    .on('change', () => {\n\n        sort(sortMode);\n        toggleSort(sortMode);\n\n        redraw();\n    });\n\nfunction filter(mode) {\n    if (mode === '#all') {\n        current = JSON.parse(JSON.stringify(all));\n    }\n    // } else if (mode === '#top5') {\n    //     current = JSON.parse(JSON.stringify(top3));\n    // } else if (mode === '#bot5') {\n    //     current = JSON.parse(JSON.stringify(bot3));\n    // }\n    filterMode = mode;\n}\n\nfunction sort(mode) {\n    if (mode === '#gdp_a') {\n        current.sort((a, b) => d3.ascending(a.dx, b.dx));\n    } else if (mode === '#gdp_b') {\n        current.sort((a, b) => d3.descending(a.dx, b.dx));\n    } else if (mode === '#orderName') {\n        current.sort((a, b) => d3.ascending(a.race, b.race));\n    }\n    x.domain(current.map(d => d.race));\n    sortMode = mode;\n}\n\nfunction toggleSort(id) {\n    d3.selectAll('.sort')\n        .style('background-color', '#eee');\n    d3.select(id)\n        .style('background-color', 'lightblue');\n}\n\n//ðŸŽ’ implement toggleFilter to highlight buttons with class .filter here (same as toggleSort with class .sort)\nfunction toggleFilter(id) {\n    d3.selectAll('.filter')\n        .style('background-color', '#eee');\n    d3.select(id)\n        .style('background-color', 'lightblue');\n}\n///\n\nfunction redraw() {\n    //update scale\n    x.domain(current.map(d => d.race));\n\n    ////////////////////////////////\n    // DATA JOIN FOR BARS.\n    var bars = svg.selectAll('.bar')\n        .data(current, d => d.race);\n\n    // UPDATE.\n    bars.transition()\n        .duration(750)\n        .delay(delay)\n        .attr('x', d => x(d.race))\n        .attr('width', x.bandwidth());\n\n    // ENTER.\n    bars.enter()\n        .append('rect')\n        .attr('x', d => x(d.race))\n        .attr('y', d => y(0))\n        .attr('width', x.bandwidth())\n        .transition()\n        .duration(750)\n        .attr('class', 'bar')\n        .attr('x', d => x(d.race))\n        .attr('y', d => y(d.dx))\n        .attr('width', x.bandwidth())\n        .attr('height', d => height - y(d.dx));\n\n    // EXIT.\n    bars.exit()\n        .transition()\n        .duration(750)\n        .style('opacity', 0)\n        .remove();\n\n    ////////////////////////////////\n    // DATA JOIN FOR NAMES.\n    var name = svg.selectAll('.name')\n        .data(current, d => d.race);\n\n    // UPDATE.\n    name.transition()\n        .duration(750)\n        .delay(delay)\n        .attr('x', (d, i) => x(d.race) + x.bandwidth() / 2);\n\n    // ENTER.\n    name.enter()\n        .append('text')\n        .attr('x', d => x(d.race) + x.bandwidth() / 2)\n        .attr('y', d => y(d.dx) + (height - y(d.dx)) / 2)\n        .style('opacity', 0)\n        .transition()\n        .duration(1000)\n        .text(d => d.race)\n        .attr('class', 'name')\n        .attr('x', d => x(d.race) + x.bandwidth() / 2)\n        .attr('y', d => y(d.dx) + (height - y(d.dx)) / 2)\n        .style('opacity', 1);\n\n    // EXIT.\n    name.exit()\n        .transition()\n        .duration(750)\n        .style('opacity', 0)\n        .remove();\n}\n\nfunction transition() {\n    var transition = svg.transition()\n        .duration(750);\n\n    transition.selectAll('.bar')\n        .delay(delay)\n        .attr('x', d => x(d.race));\n\n    transition.selectAll('.name')\n        .delay(delay)\n        .attr('x', d => x(d.race) + x.bandwidth() / 2);\n}\n\nfunction draw() {\n    x.domain(current.map(d => d.race))\n        .range([0, width])\n        .paddingInner(0.2);\n\n    y.domain([0, d3.max(current, d => d.dx)])\n        .range([height, 0]);\n\n    svg.selectAll('.bar')\n        .data(current, d => d.race)\n        .enter()\n        .append('rect')\n        .attr('class', 'bar')\n        .attr('x', d => x(d.race))\n        .attr('y', d => y(d.dx))\n        .attr('width', x.bandwidth())\n        .attr('height', d => height - y(d.dx))\n        .attr('fill', '#add8e677');\n\n    svg.selectAll('.name')\n        .data(current, d => d.race)\n        .enter()\n        .append('text')\n        .text(d => d.race)\n        .attr('class', 'name')\n        .attr('x', d => x(d.race) + x.bandwidth() / 2)\n        .attr('y', d => y(d.dx) + (height - y(d.dx)) / 2);\n\n    var xAxis;\n    xAxis = d3.axisBottom()\n        .scale(x)\n        .ticks(0)\n        .tickSize(0)\n        .tickFormat('');\n\n    svg.append('g')\n        .attr('class', 'axis')\n        .attr('transform', 'translate(0,' + height + ')')\n        .call(xAxis);\n\n\n    var yAxis = d3.axisLeft()\n        .scale(y)\n        .ticks(5, 'd');\n\n    svg.append('g')\n        .attr('class', 'axis')\n        .call(yAxis);\n\n    svg.append('text')\n        .attr('x', - height / 2)\n        .attr('y', - margin.left * 0.7)\n        .attr('transform', 'rotate(-90)')\n        .attr('text-anchor', 'middle')\n        .attr('alignment-baseline', 'central')\n        .attr('class', 'ylabel')\n        .append('tspan').text('Total diagonsed cases by race')\n        .append('tspan').text('-2')\n        .style('baseline-shift', 'super')\n        .style('font-size', '0.7em');\n}\n\n}"]},"metadata":{},"sourceType":"module"}