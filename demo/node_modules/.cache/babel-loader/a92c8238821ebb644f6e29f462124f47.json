{"ast":null,"code":"import * as d3 from 'd3';\nimport * as DOM from 'react-dom';\nexport function drawMap(height, width) {\n  function legend() {\n    let {\n      color,\n      title,\n      tickSize = 6,\n      width = 800,\n      height = 50 + tickSize,\n      marginTop = 18,\n      marginRight = 0,\n      marginBottom = 16 + tickSize,\n      marginLeft = 0,\n      ticks = width / 64,\n      tickFormat,\n      tickValues\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const svg = d3.create(\"svg\").attr(\"width\", width).attr(\"height\", height).attr(\"viewBox\", [0, 0, width, height]).style(\"overflow\", \"visible\").style(\"display\", \"block\");\n    let x; //discrete\n\n    if (color.invertExtent) {\n      const thresholds = color.thresholds ? color.thresholds() // scaleQuantize\n      : color.quantiles ? color.quantiles() // scaleQuantile\n      : color.domain(); // scaleThreshold\n\n      const thresholdFormat = tickFormat === undefined ? d => d : typeof tickFormat === \"string\" ? d3.format(tickFormat) : tickFormat;\n      x = d3.scaleLinear().domain([-1, color.range().length - 1]).rangeRound([marginLeft, width - marginRight]);\n      svg.append(\"g\").selectAll(\"rect\").data(color.range()).join(\"rect\").attr(\"x\", (d, i) => x(i - 1)).attr(\"y\", marginTop).attr(\"width\", (d, i) => x(i) - x(i - 1)).attr(\"height\", height - marginTop - marginBottom).attr(\"fill\", d => d);\n      tickValues = d3.range(thresholds.length);\n\n      tickFormat = i => thresholdFormat(thresholds[i], i);\n    }\n\n    svg.append(\"g\").attr(\"transform\", \"translate(0, \".concat(height - marginBottom, \")\")).call(d3.axisBottom(x).ticks(ticks, typeof tickFormat === \"string\" ? tickFormat : undefined).tickFormat(typeof tickFormat === \"function\" ? tickFormat : undefined).tickSize(tickSize).tickValues(tickValues)).call(g => g.selectAll(\".tick line\").attr(\"y1\", marginTop + marginBottom - height)).call(g => g.select(\".domain\").remove()).call(g => g.append(\"text\").attr(\"y\", marginTop + marginBottom - height - 6).attr(\"fill\", \"currentColor\").attr(\"text-anchor\", \"start\").attr(\"font-weight\", \"bold\").text(title));\n    return svg.node();\n  }\n\n  function ramp(color) {\n    let n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 256;\n    const canvas = DOM.canvas(n, 1);\n    const context = canvas.getContext(\"2d\");\n\n    for (let i = 0; i < n; ++i) {\n      context.fillStyle = color(i / (n - 1));\n      context.fillRect(i, 0, 1, 1);\n    }\n\n    return canvas;\n  } /////////////////////////////////////////////////////////////\n\n\n  var promises = [];\n  promises.push(d3.json(\"https://raw.githubusercontent.com/Heun-Johnson/dsci554projectdata/main/coh_area_simplified_rw.json\"));\n  promises.push(d3.json(\"https://raw.githubusercontent.com/Heun-Johnson/dsci554projectdata/main/data.json\"));\n  Promise.all(promises).then(function (values) {\n    var la_map = values[0];\n    var canc_data = values[1];\n    var color = d3.scaleQuantize([0, 36], d3.schemeGreys[9]);\n    var canc_data = Object.assign(new Map(canc_data.slice(1).map(_ref => {\n      let [zip_code, zip_canc_deaths_10k] = _ref;\n      return [zip_code, +zip_canc_deaths_10k];\n    })));\n    canc_data.title = \"2019 cancer deaths per 10k\";\n    var svg = d3.select('#map1');\n    var width = 1200;\n    var height = 800;\n    var projection = d3.geoMercator().fitSize([width, height], la_map);\n    var path = d3.geoPath().projection(projection);\n    svg.append(\"g\").attr(\"transform\", \"translate(1000,80)\").append(() => legend({\n      color,\n      title: canc_data.title,\n      width: 200\n    }));\n    svg.append('g').attr('class', 'zipcodes').selectAll(\"path\").data(la_map.features).enter().append('path').attr('d', path).attr(\"fill\", d => color(canc_data.get(d.properties.zcta))).on('mouseover', function () {\n      d3.select('#chor_info1').text('Zip code: ' + this.__data__.properties.zcta + ' - Total population: ' + this.__data__.properties.tot_pop + ' - Median age: ' + this.__data__.properties.age_median + ' years');\n      d3.select(this).style(\"stroke\", 'blue').style(\"stroke-width\", 3);\n    }).on(\"mouseout\", function () {\n      d3.select(this).style(\"stroke\", 'black').style(\"stroke-width\", 0.2);\n    });\n    var coh_hosp = [-117.97265500193778, 34.131232240226815];\n    var marker = projection(coh_hosp);\n    svg.append('circle').attr('cx', marker[0]).attr('cy', marker[1]).attr('fill', 'blue').attr('r', 10);\n  });\n}","map":{"version":3,"sources":["/Users/carlin/Desktop/USC_classes/DSCI_554/project-datadocs-real/demo/src/views/charts/MapChart.js"],"names":["d3","DOM","drawMap","height","width","legend","color","title","tickSize","marginTop","marginRight","marginBottom","marginLeft","ticks","tickFormat","tickValues","svg","create","attr","style","x","invertExtent","thresholds","quantiles","domain","thresholdFormat","undefined","d","format","scaleLinear","range","length","rangeRound","append","selectAll","data","join","i","call","axisBottom","g","select","remove","text","node","ramp","n","canvas","context","getContext","fillStyle","fillRect","promises","push","json","Promise","all","then","values","la_map","canc_data","scaleQuantize","schemeGreys","Object","assign","Map","slice","map","zip_code","zip_canc_deaths_10k","projection","geoMercator","fitSize","path","geoPath","features","enter","get","properties","zcta","on","__data__","tot_pop","age_median","coh_hosp","marker"],"mappings":"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","sourcesContent":["import * as d3 from 'd3';\nimport * as DOM from 'react-dom';\n\nexport function drawMap(height, width){\n  \n\n\n    function legend({\n        color,\n        title,\n        tickSize = 6,\n        width = 800,\n        height = 50 + tickSize,\n        marginTop = 18,\n        marginRight = 0,\n        marginBottom = 16 + tickSize,\n        marginLeft = 0,\n        ticks = width / 64,\n        tickFormat,\n        tickValues\n    } = {}) {  \n    \n        const svg = d3.create(\"svg\")\n            .attr(\"width\", width)\n            .attr(\"height\", height)\n            .attr(\"viewBox\", [0, 0, width, height])\n            .style(\"overflow\", \"visible\")\n            .style(\"display\", \"block\");\n    \n        let x;\n    \n    \n        //discrete\n        if (color.invertExtent) {\n            const thresholds\n                = color.thresholds ? color.thresholds() // scaleQuantize\n                    : color.quantiles ? color.quantiles() // scaleQuantile\n                        : color.domain(); // scaleThreshold\n    \n            const thresholdFormat\n                = tickFormat === undefined ? d => d\n                    : typeof tickFormat === \"string\" ? d3.format(tickFormat)\n                        : tickFormat;\n    \n            x = d3.scaleLinear()\n                .domain([-1, color.range().length - 1])\n                .rangeRound([marginLeft, width - marginRight]);\n    \n            svg.append(\"g\")\n                .selectAll(\"rect\")\n                .data(color.range())\n                .join(\"rect\")\n                .attr(\"x\", (d, i) => x(i - 1))\n                .attr(\"y\", marginTop)\n                .attr(\"width\", (d, i) => x(i) - x(i - 1))\n                .attr(\"height\", height - marginTop - marginBottom)\n                .attr(\"fill\", d => d);\n    \n            tickValues = d3.range(thresholds.length);\n            tickFormat = i => thresholdFormat(thresholds[i], i);\n        }\n    \n        svg.append(\"g\")\n            .attr(\"transform\", `translate(0, ${height - marginBottom})`)\n            .call(d3.axisBottom(x)\n                .ticks(ticks, typeof tickFormat === \"string\" ? tickFormat : undefined)\n                .tickFormat(typeof tickFormat === \"function\" ? tickFormat : undefined)\n                .tickSize(tickSize)\n                .tickValues(tickValues))\n            .call(g => g.selectAll(\".tick line\").attr(\"y1\", marginTop + marginBottom - height))\n            .call(g => g.select(\".domain\").remove())\n            .call(g => g.append(\"text\")\n                .attr(\"y\", marginTop + marginBottom - height - 6)\n                .attr(\"fill\", \"currentColor\")\n                .attr(\"text-anchor\", \"start\")\n                .attr(\"font-weight\", \"bold\")\n                .text(title));\n    \n        return svg.node();\n    }\n    \n    function ramp(color, n = 256) {\n        const canvas = DOM.canvas(n, 1);\n        const context = canvas.getContext(\"2d\");\n        for (let i = 0; i < n; ++i) {\n            context.fillStyle = color(i / (n - 1));\n            context.fillRect(i, 0, 1, 1);\n        }\n        return canvas;\n    }\n    \n    /////////////////////////////////////////////////////////////\n    \n    \n    var promises = [];\n    \n    promises.push(d3.json(\"https://raw.githubusercontent.com/Heun-Johnson/dsci554projectdata/main/coh_area_simplified_rw.json\"));\n    promises.push(d3.json(\"https://raw.githubusercontent.com/Heun-Johnson/dsci554projectdata/main/data.json\"));\n    \n    Promise.all(promises).then(function (values) {  \n        var la_map = values[0];\n        var canc_data = values[1];\n    \n        var color = d3.scaleQuantize([0, 36], d3.schemeGreys[9])  \n    \n        var canc_data = Object.assign(new Map(canc_data.slice(1).map(([zip_code,zip_canc_deaths_10k]) => [zip_code, +zip_canc_deaths_10k])));  \n    \n        canc_data.title = \"2019 cancer deaths per 10k\";\n    \n        var svg = d3.select('#map1');\n        var width = 1200;\n        var height = 800;\n    \n        var projection = d3.geoMercator()\n            .fitSize([width, height], la_map);\n            \n        var path = d3.geoPath()\n            .projection(projection);\n    \n        svg.append(\"g\")\n            .attr(\"transform\", \"translate(1000,80)\")\n            .append(() => legend({ color, title: canc_data.title, width: 200 }));\n    \n        svg.append('g')\n            .attr('class', 'zipcodes')\n            .selectAll(\"path\")\n            .data(la_map.features)\n            .enter()\n            .append('path')\n            .attr('d', path)\n            .attr(\"fill\", d => color(canc_data.get(d.properties.zcta))) \n            .on('mouseover', function () {            \n                d3.select('#chor_info1')\n                    .text('Zip code: ' +  this.__data__.properties.zcta +  ' - Total population: ' +  this.__data__.properties.tot_pop + ' - Median age: ' +  this.__data__.properties.age_median + ' years');               \n                d3.select(this).style(\"stroke\", 'blue').style(\"stroke-width\",3);\n                })\n            .on(\"mouseout\", function () {\n              d3.select(this).style(\"stroke\", 'black').style(\"stroke-width\",0.2);\n            });    \n    \n    \n        var coh_hosp = [-117.97265500193778, 34.131232240226815];\n    \n        var marker = projection(coh_hosp);\n    \n        svg.append('circle')\n            .attr('cx', marker[0])\n            .attr('cy', marker[1])\n            .attr('fill', 'blue')\n            .attr('r', 10);\n    });\n    \n    \n}\n"]},"metadata":{},"sourceType":"module"}